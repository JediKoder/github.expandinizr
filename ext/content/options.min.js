function getAuthorizedSites(){chrome.permissions.getAll(function(i){allPermissions=i})}function showAuthorizedSites(){chrome.permissions.getAll(function(i){allPermissions=i,chrome.storage.sync.get({public_gist_enabled:!0,public_github_enabled:!0},function(e){extOptions=e,$.each(i.origins,function(i,e){if("https://gist.github.com/*"==e||"https://github.com/*"==e){var n=$('<li id="new_auth_url_'+i+'">\r\n                            <div>\r\n                              <input id="unauth_url_submit'+i+'" class="btn btn-sm btn-danger" type="submit" value="Disable">\r\n                            </div>\r\n                            <strong>'+e+"</strong>\r\n                        </li>");("https://gist.github.com/*"!=e||extOptions.public_gist_enabled)&&("https://github.com/*"!=e||extOptions.public_github_enabled)?n.find("input").click(function(){removeAuthorizedSite(i,e)}):(console.debug(e+" "+extOptions.public_gist_enabled),n.find("input").removeClass("btn-danger").addClass("btn-primary").val("Enable").click(function(){addAuthorizedSite(i,e)})),$("#permissions").prepend(n)}else{var n=$('<li id="new_auth_url_'+i+'">\r\n                            <div>\r\n                              <input id="unauth_url_submit'+i+'" class="btn btn-sm btn-danger" type="submit" value="Unauthorize">\r\n                            </div>\r\n                          <strong>'+e+"</strong>\r\n                        </li>");n.find("input").click(function(){removeAuthorizedSite(i,e)}),$("#new_auth_url_item").before(n)}})})})}function addAuthorizedSite(i,e){if(console.debug(i+" "+e),void 0!=i&&void 0!=e)"https://gist.github.com/*"==e?(chrome.storage.sync.set({public_gist_enabled:!0}),$("#new_auth_url_"+i).find("input").removeClass("btn-primary").addClass("btn-danger").val("Disable").unbind("click").click(function(){removeAuthorizedSite(i,e)})):"https://github.com/*"==e&&(chrome.storage.sync.set({public_github_enabled:!0}),$("#new_auth_url_"+i).find("input").removeClass("btn-primary").addClass("btn-danger").val("Disable").unbind("click").click(function(){removeAuthorizedSite(i,e)}));else{var n=$("#new_auth_url").val().trim();""!=n&&("/*"!=n.slice(-2)&&(n+="/*"),"/"===n.slice(-1)&&(n+="*")),chrome.permissions.contains({origins:[n]},function(i){i?$("li:contains("+n+")").addClass("highlight").delay(4500).queue(function(){$(this).removeClass("highlight"),$(this).dequeue()}):chrome.permissions.request({origins:[n]},function(i){if(i){getAuthorizedSites();var e=allPermissions.origins.length,t=$('<li id="new_auth_url_'+e+'">\r\n                                <div>\r\n                                  <input id="unauth_url_submit'+e+'" class="btn btn-sm btn-danger" type="submit" value="Unauthorize">\r\n                                </div>\r\n                              <strong>'+n+"</strong>\r\n                            </li>");t.find("input").click(function(){removeAuthorizedSite(e,n)}),$("#new_auth_url_item").before(t),$("#new_auth_url").val("")}else{var s=chrome.runtime.lastError;s&&(console.log(s.message),alert(s.message))}})})}}function removeAuthorizedSite(i,e){var n=confirm("Really remove/disable "+e+"?");n&&chrome.permissions.contains({origins:[e]},function(n){n?"https://gist.github.com/*"==e?(chrome.storage.sync.set({public_gist_enabled:!1}),$("#new_auth_url_"+i).find("input").removeClass("btn-danger").addClass("btn-primary").val("Enable").unbind("click").bind("click",function(){addAuthorizedSite(i,e)})):"https://github.com/*"==e?(chrome.storage.sync.set({public_github_enabled:!1}),$("#new_auth_url_"+i).find("input").removeClass("btn-danger").addClass("btn-primary").val("Enable").unbind("click").bind("click",function(){addAuthorizedSite(i,e)})):chrome.permissions.remove({origins:[e]},function(e){e?$("#new_auth_url_"+i).remove():alert("Required permissions cannot be removed.")}):console.debug("not found")})}function setupUI(){showAuthorizedSites(),$("#new_auth_url_submit").click(addAuthorizedSite)}var allPermissions={},extOptions={};document.addEventListener("DOMContentLoaded",setupUI);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9wdGlvbnMuanMiXSwibmFtZXMiOlsiZ2V0QXV0aG9yaXplZFNpdGVzIiwiY2hyb21lIiwicGVybWlzc2lvbnMiLCJnZXRBbGwiLCJhbGxQZXJtaXNzaW9ucyIsInNob3dBdXRob3JpemVkU2l0ZXMiLCJzdG9yYWdlIiwic3luYyIsImdldCIsInB1YmxpY19naXN0X2VuYWJsZWQiLCJwdWJsaWNfZ2l0aHViX2VuYWJsZWQiLCJvcHRpb25zIiwiZXh0T3B0aW9ucyIsIiQiLCJlYWNoIiwib3JpZ2lucyIsImtleSIsInZhbHVlIiwibmV3SXRlbSIsImZpbmQiLCJjbGljayIsInJlbW92ZUF1dGhvcml6ZWRTaXRlIiwiY29uc29sZSIsImRlYnVnIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsInZhbCIsImFkZEF1dGhvcml6ZWRTaXRlIiwicHJlcGVuZCIsImJlZm9yZSIsImlkIiwiVVJMIiwidW5kZWZpbmVkIiwic2V0IiwidW5iaW5kIiwibmV3VVJMIiwidHJpbSIsInNsaWNlIiwiY29udGFpbnMiLCJyZXN1bHQiLCJkZWxheSIsInF1ZXVlIiwidGhpcyIsImRlcXVldWUiLCJyZXF1ZXN0IiwiZ3JhbnRlZCIsIm5ld19hdXRoX3VybF9pZCIsImxlbmd0aCIsImxhc3RFcnJvciIsInJ1bnRpbWUiLCJsb2ciLCJtZXNzYWdlIiwiYWxlcnQiLCJyIiwiY29uZmlybSIsImJpbmQiLCJyZW1vdmUiLCJyZW1vdmVkIiwic2V0dXBVSSIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciJdLCJtYXBwaW5ncyI6IkFBR0EsUUFBU0Esc0JBQ0xDLE9BQU9DLFlBQVlDLE9BQVEsU0FBVUQsR0FDakNFLGVBQWlCRixJQUl6QixRQUFTRyx1QkFDTEosT0FBT0MsWUFBWUMsT0FBUSxTQUFVRCxHQUNqQ0UsZUFBaUJGLEVBQ2pCRCxPQUFPSyxRQUFRQyxLQUFLQyxLQUNoQkMscUJBQXFCLEVBQ3JCQyx1QkFBdUIsR0FFM0IsU0FBU0MsR0FDTEMsV0FBYUQsRUFDYkUsRUFB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WkMsU0FBUyxlQUNUQyxJQUFJLFVBQ0pRLE9BQU8sU0FDUHFCLEtBQUssUUFBUyxXQUNYNUIsa0JBQWtCRyxFQUFJQyxNQUVoQix3QkFBUEEsR0FDUDlCLE9BQU9LLFFBQVFDLEtBQUswQixLQUFNdkIsdUJBQXVCLElBQ2pERyxFQUFFLGlCQUFtQmlCLEdBQ2hCWCxLQUFLLFNBQ0xLLFlBQVksY0FDWkMsU0FBUyxlQUNUQyxJQUFJLFVBQ0pRLE9BQU8sU0FDUHFCLEtBQUssUUFBUyxXQUNYNUIsa0JBQWtCRyxFQUFJQyxNQUc5QjlCLE9BQU9DLFlBQVlzRCxRQUNmekMsU0FBVWdCLElBQ1AsU0FBUzBCLEdBQ1JBLEVBRUE1QyxFQUFFLGlCQUFtQmlCLEdBQUkwQixTQUl6QkosTUFBTSw2Q0FNcEI5QixRQUFRQyxNQUFNLGVBTTVCLFFBQVNtQyxXQUNMckQsc0JBQ0FRLEVBQUUsd0JBQXdCTyxNQUFNTyxtQkF4TnBDLEdBQUl2QixtQkFDQVEsYUEwTkorQyxVQUFTQyxpQkFBaUIsbUJBQW9CRiIsImZpbGUiOiJvcHRpb25zLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFsbFBlcm1pc3Npb25zID0ge31cclxudmFyIGV4dE9wdGlvbnMgICAgID0ge31cclxuXHJcbmZ1bmN0aW9uIGdldEF1dGhvcml6ZWRTaXRlcygpIHtcclxuICAgIGNocm9tZS5wZXJtaXNzaW9ucy5nZXRBbGwoIGZ1bmN0aW9uIChwZXJtaXNzaW9ucykge1xyXG4gICAgICAgIGFsbFBlcm1pc3Npb25zID0gcGVybWlzc2lvbnM7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2hvd0F1dGhvcml6ZWRTaXRlcygpIHtcclxuICAgIGNocm9tZS5wZXJtaXNzaW9ucy5nZXRBbGwoIGZ1bmN0aW9uIChwZXJtaXNzaW9ucykge1xyXG4gICAgICAgIGFsbFBlcm1pc3Npb25zID0gcGVybWlzc2lvbnM7XHJcbiAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5nZXQoe1xyXG4gICAgICAgICAgICBwdWJsaWNfZ2lzdF9lbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBwdWJsaWNfZ2l0aHViX2VuYWJsZWQ6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgZXh0T3B0aW9ucyA9IG9wdGlvbnM7XHJcbiAgICAgICAgICAgICQuZWFjaChwZXJtaXNzaW9ucy5vcmlnaW5zLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09IFwiaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vKlwiIHx8IHZhbHVlID09IFwiaHR0cHM6Ly9naXRodWIuY29tLypcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIG9wdGlvbnMgYW5kIHNldCBidXR0b25nXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0l0ZW0gPSAkKFwiPGxpIGlkPVxcXCJuZXdfYXV0aF91cmxfXCIgKyBrZXkgKyBcIlxcXCI+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGlkPVxcXCJ1bmF1dGhfdXJsX3N1Ym1pdFwiICsga2V5ICsgXCJcXFwiIGNsYXNzPVxcXCJidG4gYnRuLXNtIGJ0bi1kYW5nZXJcXFwiIHR5cGU9XFxcInN1Ym1pdFxcXCIgdmFsdWU9XFxcIkRpc2FibGVcXFwiPlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cm9uZz5cIiArIHZhbHVlICsgXCI8L3N0cm9uZz5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gXCJodHRwczovL2dpc3QuZ2l0aHViLmNvbS8qXCIgJiYgIWV4dE9wdGlvbnMucHVibGljX2dpc3RfZW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKHZhbHVlICsgXCIgXCIgKyBleHRPcHRpb25zLnB1YmxpY19naXN0X2VuYWJsZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJdGVtLmZpbmQoXCJpbnB1dFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKFwiYnRuLWRhbmdlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKFwiYnRuLXByaW1hcnlcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC52YWwoXCJFbmFibGVcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRBdXRob3JpemVkU2l0ZShrZXksIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT0gXCJodHRwczovL2dpdGh1Yi5jb20vKlwiICYmICFleHRPcHRpb25zLnB1YmxpY19naXRodWJfZW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKHZhbHVlICsgXCIgXCIgKyBleHRPcHRpb25zLnB1YmxpY19naXN0X2VuYWJsZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJdGVtLmZpbmQoXCJpbnB1dFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKFwiYnRuLWRhbmdlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKFwiYnRuLXByaW1hcnlcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC52YWwoXCJFbmFibGVcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRBdXRob3JpemVkU2l0ZShrZXksIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0l0ZW0uZmluZChcImlucHV0XCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQXV0aG9yaXplZFNpdGUoa2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkKFwiI3Blcm1pc3Npb25zXCIpLnByZXBlbmQobmV3SXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtID0gJChcIjxsaSBpZD1cXFwibmV3X2F1dGhfdXJsX1wiICsga2V5ICsgXCJcXFwiPlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBpZD1cXFwidW5hdXRoX3VybF9zdWJtaXRcIiArIGtleSArIFwiXFxcIiBjbGFzcz1cXFwiYnRuIGJ0bi1zbSBidG4tZGFuZ2VyXFxcIiB0eXBlPVxcXCJzdWJtaXRcXFwiIHZhbHVlPVxcXCJVbmF1dGhvcml6ZVxcXCI+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cm9uZz5cIiArIHZhbHVlICsgXCI8L3N0cm9uZz5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBuZXdJdGVtLmZpbmQoXCJpbnB1dFwiKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUF1dGhvcml6ZWRTaXRlKGtleSwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI25ld19hdXRoX3VybF9pdGVtXCIpLmJlZm9yZShuZXdJdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkQXV0aG9yaXplZFNpdGUoaWQsIFVSTCkge1xyXG4gICAgY29uc29sZS5kZWJ1ZyhpZCArIFwiIFwiICsgVVJMKTtcclxuICAgIGlmIChpZCAhPSB1bmRlZmluZWQgJiYgVVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGlmIChVUkwgPT0gXCJodHRwczovL2dpc3QuZ2l0aHViLmNvbS8qXCIpIHtcclxuICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQoeyBwdWJsaWNfZ2lzdF9lbmFibGVkOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAkKFwiI25ld19hdXRoX3VybF9cIiArIGlkKVxyXG4gICAgICAgICAgICAgICAgLmZpbmQoXCJpbnB1dFwiKVxyXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKFwiYnRuLXByaW1hcnlcIilcclxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcImJ0bi1kYW5nZXJcIilcclxuICAgICAgICAgICAgICAgIC52YWwoXCJEaXNhYmxlXCIpXHJcbiAgICAgICAgICAgICAgICAudW5iaW5kKFwiY2xpY2tcIilcclxuICAgICAgICAgICAgICAgIC5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVBdXRob3JpemVkU2l0ZShpZCwgVVJMKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoVVJMID09IFwiaHR0cHM6Ly9naXRodWIuY29tLypcIikge1xyXG4gICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldCh7IHB1YmxpY19naXRodWJfZW5hYmxlZDogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgJChcIiNuZXdfYXV0aF91cmxfXCIgKyBpZClcclxuICAgICAgICAgICAgICAgIC5maW5kKFwiaW5wdXRcIilcclxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhcImJ0bi1wcmltYXJ5XCIpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJidG4tZGFuZ2VyXCIpXHJcbiAgICAgICAgICAgICAgICAudmFsKFwiRGlzYWJsZVwiKVxyXG4gICAgICAgICAgICAgICAgLnVuYmluZChcImNsaWNrXCIpXHJcbiAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQXV0aG9yaXplZFNpdGUoaWQsIFVSTCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZhciBuZXdVUkwgPSAkKFwiI25ld19hdXRoX3VybFwiKS52YWwoKS50cmltKCk7XHJcbiAgICAgICAgaWYgKG5ld1VSTCAhPSAnJykge1xyXG4gICAgICAgICAgICBpZiAobmV3VVJMLnNsaWNlKC0yKSAhPSAnLyonKSBuZXdVUkwgPSBuZXdVUkwgKyAnLyonXHJcbiAgICAgICAgICAgIGlmIChuZXdVUkwuc2xpY2UoLTEpID09PSAnLycpIG5ld1VSTCA9IG5ld1VSTCArICcqJ1xyXG4gICAgICAgIH1cclxuICAgICAgICBjaHJvbWUucGVybWlzc2lvbnMuY29udGFpbnMoe1xyXG4gICAgICAgICAgICBvcmlnaW5zOiBbbmV3VVJMXVxyXG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGUgZXh0ZW5zaW9uIGhhcyB0aGUgcGVybWlzc2lvbnMgYWxyZWFkeS5cclxuICAgICAgICAgICAgICAgICQoXCJsaTpjb250YWlucyhcIiArIG5ld1VSTCArIFwiKVwiKS5hZGRDbGFzcyhcImhpZ2hsaWdodFwiKVxyXG4gICAgICAgICAgICAgICAgICAgLmRlbGF5KDQ1MDApXHJcbiAgICAgICAgICAgICAgICAgICAucXVldWUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImhpZ2hsaWdodFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmRlcXVldWUoKTtcclxuICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gVGhlIGV4dGVuc2lvbiBkb2Vzbid0IGhhdmUgdGhlIHBlcm1pc3Npb25zLnNcclxuICAgICAgICAgICAgICAgIGNocm9tZS5wZXJtaXNzaW9ucy5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbnM6IFtuZXdVUkxdXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGdyYW50ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JhbnRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRBdXRob3JpemVkU2l0ZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld19hdXRoX3VybF9pZCA9IGFsbFBlcm1pc3Npb25zLm9yaWdpbnMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3NhdmVPcHRpb25zKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0l0ZW0gPSAkKFwiPGxpIGlkPVxcXCJuZXdfYXV0aF91cmxfXCIgKyBuZXdfYXV0aF91cmxfaWQgKyBcIlxcXCI+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9XFxcInVuYXV0aF91cmxfc3VibWl0XCIgKyBuZXdfYXV0aF91cmxfaWQgKyBcIlxcXCIgY2xhc3M9XFxcImJ0biBidG4tc20gYnRuLWRhbmdlclxcXCIgdHlwZT1cXFwic3VibWl0XFxcIiB2YWx1ZT1cXFwiVW5hdXRob3JpemVcXFwiPlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cm9uZz5cIiArIG5ld1VSTCArIFwiPC9zdHJvbmc+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJdGVtLmZpbmQoXCJpbnB1dFwiKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVBdXRob3JpemVkU2l0ZShuZXdfYXV0aF91cmxfaWQsIG5ld1VSTCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNuZXdfYXV0aF91cmxfaXRlbVwiKS5iZWZvcmUobmV3SXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjbmV3X2F1dGhfdXJsXCIpLnZhbChcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwZXJtaXNzaW9ucyBub3QgZ3JhbnRlZCAoYnkgdXNlciBvciBlcnJvcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RFcnJvciA9IGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhc3RFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGFzdEVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQobGFzdEVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlQXV0aG9yaXplZFNpdGUoaWQsIFVSTCkge1xyXG4gICAgLy9jb25zb2xlLmRlYnVnKGlkKTtcclxuICAgIC8vY29uc29sZS5kZWJ1ZyhVUkwpO1xyXG4gICAgdmFyIHIgPSBjb25maXJtKFwiUmVhbGx5IHJlbW92ZS9kaXNhYmxlIFwiICsgVVJMICsgXCI/XCIpO1xyXG4gICAgaWYgKHIpIHtcclxuICAgICAgICBjaHJvbWUucGVybWlzc2lvbnMuY29udGFpbnMoe1xyXG4gICAgICAgICAgICBvcmlnaW5zOiBbVVJMXVxyXG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGUgZXh0ZW5zaW9uIGhhcyB0aGUgcGVybWlzc2lvbnMuXHJcbiAgICAgICAgICAgICAgICBpZiAoVVJMID09IFwiaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vKlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQoeyBwdWJsaWNfZ2lzdF9lbmFibGVkOiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI25ld19hdXRoX3VybF9cIiArIGlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZChcImlucHV0XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhcImJ0bi1kYW5nZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKFwiYnRuLXByaW1hcnlcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnZhbChcIkVuYWJsZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudW5iaW5kKFwiY2xpY2tcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRBdXRob3JpemVkU2l0ZShpZCwgVVJMKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFVSTCA9PSBcImh0dHBzOi8vZ2l0aHViLmNvbS8qXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldCh7IHB1YmxpY19naXRodWJfZW5hYmxlZDogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNuZXdfYXV0aF91cmxfXCIgKyBpZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoXCJpbnB1dFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoXCJidG4tZGFuZ2VyXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcImJ0bi1wcmltYXJ5XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC52YWwoXCJFbmFibGVcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnVuYmluZChcImNsaWNrXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkQXV0aG9yaXplZFNpdGUoaWQsIFVSTCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjaHJvbWUucGVybWlzc2lvbnMucmVtb3ZlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luczogW1VSTF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVtb3ZlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3ZlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHBlcm1pc3Npb25zIGhhdmUgYmVlbiByZW1vdmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNuZXdfYXV0aF91cmxfXCIgKyBpZCkucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcGVybWlzc2lvbnMgaGF2ZSBub3QgYmVlbiByZW1vdmVkIChlLmcuLCB5b3UgdHJpZWQgdG8gcmVtb3ZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZXF1aXJlZCBwZXJtaXNzaW9ucykuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcIlJlcXVpcmVkIHBlcm1pc3Npb25zIGNhbm5vdCBiZSByZW1vdmVkLlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgLy8gVGhlIGV4dGVuc2lvbiBkb2Vzbid0IGhhdmUgdGhlIHBlcm1pc3Npb25zLlxyXG4gICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoXCJub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2V0dXBVSSgpIHtcclxuICAgIHNob3dBdXRob3JpemVkU2l0ZXMoKTtcclxuICAgICQoXCIjbmV3X2F1dGhfdXJsX3N1Ym1pdFwiKS5jbGljayhhZGRBdXRob3JpemVkU2l0ZSk7XHJcbn1cclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBzZXR1cFVJKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=