function getAuthorizedSites(){chrome.permissions.getAll(function(i){allPermissions=i})}function showAuthorizedSites(){chrome.permissions.getAll(function(i){allPermissions=i,chrome.storage.sync.get({public_gist_enabled:!0,public_github_enabled:!0},function(e){extOptions=e,$.each(i.origins,function(i,e){if("https://gist.github.com/*"==e||"https://github.com/*"==e){var t=$('<li id="new_auth_url_'+i+'">\r\n                            <div>\r\n                              <input id="unauth_url_submit'+i+'" class="btn btn-sm btn-danger" type="submit" value="Disable">\r\n                            </div>\r\n                            <strong>'+e+"</strong>\r\n                        </li>");("https://gist.github.com/*"!=e||extOptions.public_gist_enabled)&&("https://github.com/*"!=e||extOptions.public_github_enabled)?t.find("input").click(function(){removeAuthorizedSite(i,e)}):(console.debug(e+" "+extOptions.public_gist_enabled),t.find("input").removeClass("btn-danger").addClass("btn-primary").val("Enable").click(function(){addAuthorizedSite(i,e)})),$("#permissions").prepend(t)}else{var t=$('<li id="new_auth_url_'+i+'">\r\n                            <div>\r\n                              <input id="unauth_url_submit'+i+'" class="btn btn-sm btn-danger" type="submit" value="Unauthorize">\r\n                            </div>\r\n                          <strong>'+e+"</strong>\r\n                        </li>");t.find("input").click(function(){removeAuthorizedSite(i,e)}),$("#new_auth_url_item").before(t)}})})})}function addAuthorizedSite(i,e){if(console.debug(i+" "+e),void 0!=i&&void 0!=e)"https://gist.github.com/*"==e?(chrome.storage.sync.set({public_gist_enabled:!0}),$("#new_auth_url_"+i).find("input").removeClass("btn-primary").addClass("btn-danger").val("Disable").unbind("click").click(function(){removeAuthorizedSite(i,e)})):"https://github.com/*"==e&&(chrome.storage.sync.set({public_github_enabled:!0}),$("#new_auth_url_"+i).find("input").removeClass("btn-primary").addClass("btn-danger").val("Disable").unbind("click").click(function(){removeAuthorizedSite(i,e)}));else{var t=$("#new_auth_url").val().trim();""!=t&&("/*"!=t.slice(-2)&&(t+="/*"),"/"===t.slice(-1)&&(t+="*")),chrome.permissions.contains({origins:[t]},function(i){i?($("li:contains("+t+")").addClass("highlight").delay(4500).queue(function(){$(this).removeClass("highlight"),$(this).dequeue()}),$("#new_auth_url_msg").text("Duplicate URL - "+t)):chrome.permissions.request({origins:[t]},function(i){if(i){getAuthorizedSites();var e=allPermissions.origins.length,n=$('<li id="new_auth_url_'+e+'">\r\n                                <div>\r\n                                  <input id="unauth_url_submit'+e+'" class="btn btn-sm btn-danger" type="submit" value="Unauthorize">\r\n                                </div>\r\n                              <strong>'+t+"</strong>\r\n                            </li>");n.find("input").click(function(){removeAuthorizedSite(e,t)}),$("#new_auth_url_item").before(n),$("#new_auth_url").val(""),$("#new_auth_url_submit").prop("disabled",!0),$("#new_auth_url_msg").text("")}else{var s=chrome.runtime.lastError;s&&(console.log(s.message),$("#new_auth_url_msg").text(s.message))}})})}}function removeAuthorizedSite(i,e){var t=confirm("Really remove/disable "+e+"?");t&&chrome.permissions.contains({origins:[e]},function(t){t?"https://gist.github.com/*"==e?(chrome.storage.sync.set({public_gist_enabled:!1}),$("#new_auth_url_"+i).find("input").removeClass("btn-danger").addClass("btn-primary").val("Enable").unbind("click").bind("click",function(){addAuthorizedSite(i,e)})):"https://github.com/*"==e?(chrome.storage.sync.set({public_github_enabled:!1}),$("#new_auth_url_"+i).find("input").removeClass("btn-danger").addClass("btn-primary").val("Enable").unbind("click").bind("click",function(){addAuthorizedSite(i,e)})):chrome.permissions.remove({origins:[e]},function(e){e?$("#new_auth_url_"+i).remove():alert("Required permissions cannot be removed.")}):console.debug("not found")})}function setupUI(){showAuthorizedSites(),$("#new_auth_url_submit").click(addAuthorizedSite),$("#new_auth_url").keyup(function(){""==$(this).val()?$("#new_auth_url_submit").prop("disabled",!0):$("#new_auth_url_submit").prop("disabled",!1)})}var allPermissions={},extOptions={};document.addEventListener("DOMContentLoaded",setupUI);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9wdGlvbnMuanMiXSwibmFtZXMiOlsiZ2V0QXV0aG9yaXplZFNpdGVzIiwiY2hyb21lIiwicGVybWlzc2lvbnMiLCJnZXRBbGwiLCJhbGxQZXJtaXNzaW9ucyIsInNob3dBdXRob3JpemVkU2l0ZXMiLCJzdG9yYWdlIiwic3luYyIsImdldCIsInB1YmxpY19naXN0X2VuYWJsZWQiLCJwdWJsaWNfZ2l0aHViX2VuYWJsZWQiLCJvcHRpb25zIiwiZXh0T3B0aW9ucyIsIiQiLCJlYWNoIiwib3JpZ2lucyIsImtleSIsInZhbHVlIiwibmV3SXRlbSIsImZpbmQiLCJjbGljayIsInJlbW92ZUF1dGhvcml6ZWRTaXRlIiwiY29uc29sZSIsImRlYnVnIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsInZhbCIsImFkZEF1dGhvcml6ZWRTaXRlIiwicHJlcGVuZCIsImJlZm9yZSIsImlkIiwiVVJMIiwidW5kZWZpbmVkIiwic2V0IiwidW5iaW5kIiwibmV3VVJMIiwidHJpbSIsInNsaWNlIiwiY29udGFpbnMiLCJyZXN1bHQiLCJkZWxheSIsInF1ZXVlIiwidGhpcyIsImRlcXVldWUiLCJ0ZXh0IiwicmVxdWVzdCIsImdyYW50ZWQiLCJuZXdfYXV0aF91cmxfaWQiLCJsZW5ndGgiLCJwcm9wIiwibGFzdEVycm9yIiwicnVudGltZSIsImxvZyIsIm1lc3NhZ2UiLCJyIiwiY29uZmlybSIsImJpbmQiLCJyZW1vdmUiLCJyZW1vdmVkIiwiYWxlcnQiLCJzZXR1cFVJIiwia2V5dXAiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiXSwibWFwcGluZ3MiOiJBQUdBLFFBQVNBLHNCQUNMQyxPQUFPQyxZQUFZQyxPQUFRLFNBQVVELEdBQ2pDRSxlQUFpQkYsSUFJekIsUUFBU0csdUJBQ0xKLE9BQU9DLFlBQVlDLE9BQVEsU0FBVUQsR0FDakNFLGVBQWlCRixFQUNqQkQsT0FBT0ssUUFBUUMsS0FBS0MsS0FDaEJDLHFCQUFxQixFQUNyQkMsdUJBQXVCLEdBRTNCLFNBQVND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QUNmdkIsU0FBVWdCLElBQ1gsU0FBU1EsR0FDSkEsRUFFVyw2QkFBUFIsR0FDQTlCLE9BQU9LLFFBQVFDLEtBQUswQixLQUFNeEIscUJBQXFCLElBQy9DSSxFQUFFLGlCQUFtQmlCLEdBQ2hCWCxLQUFLLFNBQ0xLLFlBQVksY0FDWkMsU0FBUyxlQUNUQyxJQUFJLFVBQ0pRLE9BQU8sU0FDUHNCLEtBQUssUUFBUyxXQUNYN0Isa0JBQWtCRyxFQUFJQyxNQUVoQix3QkFBUEEsR0FDUDlCLE9BQU9LLFFBQVFDLEtBQUswQixLQUFNdkIsdUJBQXVCLElBQ2pERyxFQUFFLGlCQUFtQmlCLEdBQ2hCWCxLQUFLLFNBQ0xLLFlBQVksY0FDWkMsU0FBUyxlQUNUQyxJQUFJLFVBQ0pRLE9BQU8sU0FDUHNCLEtBQUssUUFBUyxXQUNYN0Isa0JBQWtCRyxFQUFJQyxNQUc5QjlCLE9BQU9DLFlBQVl1RCxRQUNmMUMsU0FBVWdCLElBQ1AsU0FBUzJCLEdBQ1JBLEVBRUE3QyxFQUFFLGlCQUFtQmlCLEdBQUkyQixTQUl6QkUsTUFBTSw2Q0FNcEJyQyxRQUFRQyxNQUFNLGVBTTVCLFFBQVNxQyxXQUNMdkQsc0JBQ0FRLEVBQUUsd0JBQXdCTyxNQUFNTyxtQkFDaENkLEVBQUUsaUJBQWlCZ0QsTUFBTyxXQUNGLElBQWpCaEQsRUFBRTZCLE1BQU1oQixNQUNQYixFQUFFLHdCQUF3Qm9DLEtBQUssWUFBWSxHQUUzQ3BDLEVBQUUsd0JBQXdCb0MsS0FBSyxZQUFZLEtBaE92RCxHQUFJN0MsbUJBQ0FRLGFBb09Ka0QsVUFBU0MsaUJBQWlCLG1CQUFvQkgiLCJmaWxlIjoib3B0aW9ucy5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhbGxQZXJtaXNzaW9ucyA9IHt9XHJcbnZhciBleHRPcHRpb25zICAgICA9IHt9XHJcblxyXG5mdW5jdGlvbiBnZXRBdXRob3JpemVkU2l0ZXMoKSB7XHJcbiAgICBjaHJvbWUucGVybWlzc2lvbnMuZ2V0QWxsKCBmdW5jdGlvbiAocGVybWlzc2lvbnMpIHtcclxuICAgICAgICBhbGxQZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dBdXRob3JpemVkU2l0ZXMoKSB7XHJcbiAgICBjaHJvbWUucGVybWlzc2lvbnMuZ2V0QWxsKCBmdW5jdGlvbiAocGVybWlzc2lvbnMpIHtcclxuICAgICAgICBhbGxQZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zO1xyXG4gICAgICAgIGNocm9tZS5zdG9yYWdlLnN5bmMuZ2V0KHtcclxuICAgICAgICAgICAgcHVibGljX2dpc3RfZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgcHVibGljX2dpdGh1Yl9lbmFibGVkOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBmdW5jdGlvbihvcHRpb25zKSB7XHJcbiAgICAgICAgICAgIGV4dE9wdGlvbnMgPSBvcHRpb25zO1xyXG4gICAgICAgICAgICAkLmVhY2gocGVybWlzc2lvbnMub3JpZ2lucywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBcImh0dHBzOi8vZ2lzdC5naXRodWIuY29tLypcIiB8fCB2YWx1ZSA9PSBcImh0dHBzOi8vZ2l0aHViLmNvbS8qXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBvcHRpb25zIGFuZCBzZXQgYnV0dG9uZ1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtID0gJChcIjxsaSBpZD1cXFwibmV3X2F1dGhfdXJsX1wiICsga2V5ICsgXCJcXFwiPlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBpZD1cXFwidW5hdXRoX3VybF9zdWJtaXRcIiArIGtleSArIFwiXFxcIiBjbGFzcz1cXFwiYnRuIGJ0bi1zbSBidG4tZGFuZ2VyXFxcIiB0eXBlPVxcXCJzdWJtaXRcXFwiIHZhbHVlPVxcXCJEaXNhYmxlXFxcIj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJvbmc+XCIgKyB2YWx1ZSArIFwiPC9zdHJvbmc+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09IFwiaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vKlwiICYmICFleHRPcHRpb25zLnB1YmxpY19naXN0X2VuYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1Zyh2YWx1ZSArIFwiIFwiICsgZXh0T3B0aW9ucy5wdWJsaWNfZ2lzdF9lbmFibGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3SXRlbS5maW5kKFwiaW5wdXRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhcImJ0bi1kYW5nZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcImJ0bi1wcmltYXJ5XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsKFwiRW5hYmxlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkQXV0aG9yaXplZFNpdGUoa2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09IFwiaHR0cHM6Ly9naXRodWIuY29tLypcIiAmJiAhZXh0T3B0aW9ucy5wdWJsaWNfZ2l0aHViX2VuYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1Zyh2YWx1ZSArIFwiIFwiICsgZXh0T3B0aW9ucy5wdWJsaWNfZ2lzdF9lbmFibGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3SXRlbS5maW5kKFwiaW5wdXRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhcImJ0bi1kYW5nZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcImJ0bi1wcmltYXJ5XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsKFwiRW5hYmxlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkQXV0aG9yaXplZFNpdGUoa2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJdGVtLmZpbmQoXCJpbnB1dFwiKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUF1dGhvcml6ZWRTaXRlKGtleSwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNwZXJtaXNzaW9uc1wiKS5wcmVwZW5kKG5ld0l0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3SXRlbSA9ICQoXCI8bGkgaWQ9XFxcIm5ld19hdXRoX3VybF9cIiArIGtleSArIFwiXFxcIj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9XFxcInVuYXV0aF91cmxfc3VibWl0XCIgKyBrZXkgKyBcIlxcXCIgY2xhc3M9XFxcImJ0biBidG4tc20gYnRuLWRhbmdlclxcXCIgdHlwZT1cXFwic3VibWl0XFxcIiB2YWx1ZT1cXFwiVW5hdXRob3JpemVcXFwiPlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJvbmc+XCIgKyB2YWx1ZSArIFwiPC9zdHJvbmc+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3SXRlbS5maW5kKFwiaW5wdXRcIikuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVBdXRob3JpemVkU2l0ZShrZXksIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNuZXdfYXV0aF91cmxfaXRlbVwiKS5iZWZvcmUobmV3SXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZEF1dGhvcml6ZWRTaXRlKGlkLCBVUkwpIHtcclxuICAgIGNvbnNvbGUuZGVidWcoaWQgKyBcIiBcIiArIFVSTCk7XHJcbiAgICBpZiAoaWQgIT0gdW5kZWZpbmVkICYmIFVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICBpZiAoVVJMID09IFwiaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vKlwiKSB7XHJcbiAgICAgICAgICAgIGNocm9tZS5zdG9yYWdlLnN5bmMuc2V0KHsgcHVibGljX2dpc3RfZW5hYmxlZDogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgJChcIiNuZXdfYXV0aF91cmxfXCIgKyBpZClcclxuICAgICAgICAgICAgICAgIC5maW5kKFwiaW5wdXRcIilcclxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhcImJ0bi1wcmltYXJ5XCIpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJidG4tZGFuZ2VyXCIpXHJcbiAgICAgICAgICAgICAgICAudmFsKFwiRGlzYWJsZVwiKVxyXG4gICAgICAgICAgICAgICAgLnVuYmluZChcImNsaWNrXCIpXHJcbiAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQXV0aG9yaXplZFNpdGUoaWQsIFVSTCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2UgaWYgKFVSTCA9PSBcImh0dHBzOi8vZ2l0aHViLmNvbS8qXCIpIHtcclxuICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQoeyBwdWJsaWNfZ2l0aHViX2VuYWJsZWQ6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICQoXCIjbmV3X2F1dGhfdXJsX1wiICsgaWQpXHJcbiAgICAgICAgICAgICAgICAuZmluZChcImlucHV0XCIpXHJcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoXCJidG4tcHJpbWFyeVwiKVxyXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKFwiYnRuLWRhbmdlclwiKVxyXG4gICAgICAgICAgICAgICAgLnZhbChcIkRpc2FibGVcIilcclxuICAgICAgICAgICAgICAgIC51bmJpbmQoXCJjbGlja1wiKVxyXG4gICAgICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUF1dGhvcml6ZWRTaXRlKGlkLCBVUkwpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB2YXIgbmV3VVJMID0gJChcIiNuZXdfYXV0aF91cmxcIikudmFsKCkudHJpbSgpO1xyXG4gICAgICAgIGlmIChuZXdVUkwgIT0gJycpIHtcclxuICAgICAgICAgICAgaWYgKG5ld1VSTC5zbGljZSgtMikgIT0gJy8qJykgbmV3VVJMID0gbmV3VVJMICsgJy8qJ1xyXG4gICAgICAgICAgICBpZiAobmV3VVJMLnNsaWNlKC0xKSA9PT0gJy8nKSBuZXdVUkwgPSBuZXdVUkwgKyAnKidcclxuICAgICAgICB9XHJcbiAgICAgICAgY2hyb21lLnBlcm1pc3Npb25zLmNvbnRhaW5zKHtcclxuICAgICAgICAgICAgb3JpZ2luczogW25ld1VSTF1cclxuICAgICAgICB9LCBmdW5jdGlvbihyZXN1bHQpIHtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gVGhlIGV4dGVuc2lvbiBoYXMgdGhlIHBlcm1pc3Npb25zIGFscmVhZHkuXHJcbiAgICAgICAgICAgICAgICAkKFwibGk6Y29udGFpbnMoXCIgKyBuZXdVUkwgKyBcIilcIikuYWRkQ2xhc3MoXCJoaWdobGlnaHRcIilcclxuICAgICAgICAgICAgICAgICAgIC5kZWxheSg0NTAwKVxyXG4gICAgICAgICAgICAgICAgICAgLnF1ZXVlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJoaWdobGlnaHRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5kZXF1ZXVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICQoXCIjbmV3X2F1dGhfdXJsX21zZ1wiKS50ZXh0KFwiRHVwbGljYXRlIFVSTCAtIFwiICsgbmV3VVJMKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIFRoZSBleHRlbnNpb24gZG9lc24ndCBoYXZlIHRoZSBwZXJtaXNzaW9ucy5zXHJcbiAgICAgICAgICAgICAgICBjaHJvbWUucGVybWlzc2lvbnMucmVxdWVzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5zOiBbbmV3VVJMXVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChncmFudGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdyYW50ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0QXV0aG9yaXplZFNpdGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdfYXV0aF91cmxfaWQgPSBhbGxQZXJtaXNzaW9ucy5vcmlnaW5zLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9zYXZlT3B0aW9ucygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtID0gJChcIjxsaSBpZD1cXFwibmV3X2F1dGhfdXJsX1wiICsgbmV3X2F1dGhfdXJsX2lkICsgXCJcXFwiPlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGlkPVxcXCJ1bmF1dGhfdXJsX3N1Ym1pdFwiICsgbmV3X2F1dGhfdXJsX2lkICsgXCJcXFwiIGNsYXNzPVxcXCJidG4gYnRuLXNtIGJ0bi1kYW5nZXJcXFwiIHR5cGU9XFxcInN1Ym1pdFxcXCIgdmFsdWU9XFxcIlVuYXV0aG9yaXplXFxcIj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJvbmc+XCIgKyBuZXdVUkwgKyBcIjwvc3Ryb25nPlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3SXRlbS5maW5kKFwiaW5wdXRcIikuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQXV0aG9yaXplZFNpdGUobmV3X2F1dGhfdXJsX2lkLCBuZXdVUkwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjbmV3X2F1dGhfdXJsX2l0ZW1cIikuYmVmb3JlKG5ld0l0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiI25ld19hdXRoX3VybFwiKS52YWwoXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjbmV3X2F1dGhfdXJsX3N1Ym1pdFwiKS5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiI25ld19hdXRoX3VybF9tc2dcIikudGV4dChcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwZXJtaXNzaW9ucyBub3QgZ3JhbnRlZCAoYnkgdXNlciBvciBlcnJvcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RFcnJvciA9IGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhc3RFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobGFzdEVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNuZXdfYXV0aF91cmxfbXNnXCIpLnRleHQobGFzdEVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlQXV0aG9yaXplZFNpdGUoaWQsIFVSTCkge1xyXG4gICAgLy9jb25zb2xlLmRlYnVnKGlkKTtcclxuICAgIC8vY29uc29sZS5kZWJ1ZyhVUkwpO1xyXG4gICAgdmFyIHIgPSBjb25maXJtKFwiUmVhbGx5IHJlbW92ZS9kaXNhYmxlIFwiICsgVVJMICsgXCI/XCIpO1xyXG4gICAgaWYgKHIpIHtcclxuICAgICAgICBjaHJvbWUucGVybWlzc2lvbnMuY29udGFpbnMoe1xyXG4gICAgICAgICAgICBvcmlnaW5zOiBbVVJMXVxyXG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGUgZXh0ZW5zaW9uIGhhcyB0aGUgcGVybWlzc2lvbnMuXHJcbiAgICAgICAgICAgICAgICBpZiAoVVJMID09IFwiaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vKlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQoeyBwdWJsaWNfZ2lzdF9lbmFibGVkOiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI25ld19hdXRoX3VybF9cIiArIGlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZChcImlucHV0XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhcImJ0bi1kYW5nZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKFwiYnRuLXByaW1hcnlcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnZhbChcIkVuYWJsZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudW5iaW5kKFwiY2xpY2tcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRBdXRob3JpemVkU2l0ZShpZCwgVVJMKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFVSTCA9PSBcImh0dHBzOi8vZ2l0aHViLmNvbS8qXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldCh7IHB1YmxpY19naXRodWJfZW5hYmxlZDogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNuZXdfYXV0aF91cmxfXCIgKyBpZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoXCJpbnB1dFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoXCJidG4tZGFuZ2VyXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcImJ0bi1wcmltYXJ5XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC52YWwoXCJFbmFibGVcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnVuYmluZChcImNsaWNrXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkQXV0aG9yaXplZFNpdGUoaWQsIFVSTCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjaHJvbWUucGVybWlzc2lvbnMucmVtb3ZlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luczogW1VSTF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVtb3ZlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3ZlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHBlcm1pc3Npb25zIGhhdmUgYmVlbiByZW1vdmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNuZXdfYXV0aF91cmxfXCIgKyBpZCkucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcGVybWlzc2lvbnMgaGF2ZSBub3QgYmVlbiByZW1vdmVkIChlLmcuLCB5b3UgdHJpZWQgdG8gcmVtb3ZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZXF1aXJlZCBwZXJtaXNzaW9ucykuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcIlJlcXVpcmVkIHBlcm1pc3Npb25zIGNhbm5vdCBiZSByZW1vdmVkLlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgLy8gVGhlIGV4dGVuc2lvbiBkb2Vzbid0IGhhdmUgdGhlIHBlcm1pc3Npb25zLlxyXG4gICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoXCJub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2V0dXBVSSgpIHtcclxuICAgIHNob3dBdXRob3JpemVkU2l0ZXMoKTtcclxuICAgICQoXCIjbmV3X2F1dGhfdXJsX3N1Ym1pdFwiKS5jbGljayhhZGRBdXRob3JpemVkU2l0ZSk7XHJcbiAgICAkKFwiI25ld19hdXRoX3VybFwiKS5rZXl1cCggZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKCQodGhpcykudmFsKCkgPT0gJycgKSB7XHJcbiAgICAgICAgICAgICQoXCIjbmV3X2F1dGhfdXJsX3N1Ym1pdFwiKS5wcm9wKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJChcIiNuZXdfYXV0aF91cmxfc3VibWl0XCIpLnByb3AoXCJkaXNhYmxlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBzZXR1cFVJKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=